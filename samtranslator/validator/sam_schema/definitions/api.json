{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "additionalProperties": false,
  "definitions": {
    "AWS::Serverless::Api": {
      "if": {
        "properties": {
          "Type": {
            "const": "AWS::Serverless::Api"
          }
        }
      },
      "then": {
        "additionalProperties": false,
        "properties": {
          "Metadata": {
            "type": "object"
          },
          "Properties": {
            "additionalProperties": false,
            "properties": {
              "AccessLogSetting": {
                "$ref": "file:cfn.json#definitions/AccessLogSetting"
              },
              "Auth": {
                "$ref": "#definitions/AWS::Serverless::Api.Auth"
              },
              "BinaryMediaTypes": {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              "CacheClusterEnabled": {
                "type": "boolean"
              },
              "CacheClusterSize": {
                "type": "string"
              },
              "CanarySetting": {
                "$ref": "file:cfn.json#definitions/AWS::ApiGateway::Stage.CanarySetting"
              },
              "Cors": {
                "if": {
                  "type": "string"
                },
                "then": {
                  "minLength": 1
                },
                "else": {
                  "$ref": "#definitions/AWS::Serverless::Api.CorsConfiguration"
                }
              },
              "DefinitionBody": {
                "anyOf": [
                  {
                    "type": "string"
                  },
                  {
                    "type": "object"
                  }
                ]
              },
              "DefinitionUri": {
                "anyOf": [
                  {
                    "type": "string"
                  },
                  {
                    "$ref": "#definitions/AWS::Serverless::Api.S3Location"
                  }
                ]
              },
              "Description": {
                "type": "string"
              },
              "Domain": {
                "$ref": "#definitions/AWS::Serverless::Api.DomainConfiguration"
              },
              "EndpointConfiguration": {
                "$ref": "#definitions/AWS::Serverless::Api.EndpointConfiguration"
              },
              "GatewayResponses": {
                "$ref": "file:common.json#definitions/GatewayResponses",
                "references": [
                  "https://docs.aws.amazon.com/apigateway/api-reference/resource/gateway-response/"
                ]
              },
              "MethodSettings": {
                "items": {
                  "$ref": "file:cfn.json#definitions/AWS::ApiGateway::Stage.MethodSetting"
                },
                "type": "array"
              },
              "MinimumCompressionSize": {
                "maximum": 10485760,
                "minimum": 0,
                "type": "integer"
              },
              "Models": {
                "type": "object"
              },
              "Name": {
                "type": "string"
              },
              "OpenApiVersion": {
                "type": "string"
              },
              "StageName": {
                "type": "string"
              },
              "Tags": {
                "$ref": "file:common.json#definitions/TagsMap"
              },
              "TracingEnabled": {
                "type": "boolean"
              },
              "Variables": {
                "additionalProperties": false,
                "patternProperties": {
                  "^[a-zA-Z0-9]+$": {
                    "pattern": "[A-Za-z0-9._~:/?#&=,-]+",
                    "type": "string"
                  }
                },
                "type": "object"
              }
            },
            "required": [
              "StageName"
            ],
            "type": "object"
          },
          "Type": {
            "const": "AWS::Serverless::Api"
          }
        },
        "required": [
          "Type",
          "Properties"
        ],
        "type": "object"
      }
    },
    "AWS::Serverless::Api.ApiUsagePlan": {
      "additionalProperties": false,
      "properties": {
        "CreateUsagePlan": {
          "enum": [
            "PER_API",
            "SHARED",
            "NONE"
          ],
          "type": "string"
        },
        "Description": {
          "type": "string"
        },
        "Quota": {
          "$ref": "file:cfn.json#definitions/AWS::ApiGateway::UsagePlan.QuotaSettings"
        },
        "Tags": {
          "$ref": "file:common.json#definitions/TagsList"
        },
        "Throttle": {
          "$ref": "file:cfn.json#definitions/AWS::ApiGateway::UsagePlan.ThrottleSettings"
        },
        "UsagePlanName": {
          "type": "string"
        }
      },
      "required": [
        "CreateUsagePlan"
      ]
    },
    "AWS::Serverless::Api.Auth": {
      "additionalProperties": false,
      "properties": {
        "AddDefaultAuthorizerToCorsPreflight": {
          "type": "boolean"
        },
        "ApiKeyRequired": {
          "type": "boolean"
        },
        "Authorizers": {
          "additionalProperties": false,
          "patternProperties": {
            "^[a-zA-Z0-9]+$": {
              "allOf": [
                {
                  "$ref": "#definitions/AWS::Serverless::Api.CognitoAuthorizer"
                },
                {
                  "$ref": "#definitions/AWS::Serverless::Api.LambdaAuthorizer"
                }
              ]
            }
          },
          "type": "object"
        },
        "DefaultAuthorizer": {
          "type": "string"
        },
        "InvokeRole": {
          "enum": [
            "CALLER_CREDENTIALS",
            "NONE",
            "IAMRoleArn"
          ],
          "type": "string"
        },
        "ResourcePolicy": {
          "$ref": "#definitions/AWS::Serverless::Api.ResourcePolicyStatement"
        },
        "UsagePlan": {
          "$ref": "#definitions/AWS::Serverless::Api.ApiUsagePlan"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.CognitoAuthorizer": {
      "if": {
        "required": [
          "UserPoolArn"
        ]
      },
      "then": {
        "additionalProperties": false,
        "properties": {
          "AuthorizationScopes": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "Identity": {
            "$ref": "#definitions/AWS::Serverless::Api.CognitoAuthorizationIdentity"
          },
          "UserPoolArn": {
            "type": "string"
          }
        },
        "required": [
          "UserPoolArn"
        ],
        "type": "object"
      }
    },
    "AWS::Serverless::Api.CognitoAuthorizationIdentity": {
      "additionalProperties": false,
      "properties": {
        "Header": {
          "type": "string"
        },
        "ReauthorizeEvery": {
          "type": "integer",
          "maximum": 3600,
          "minimum": 1
        },
        "ValidationExpression": {
          "type": "string"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.CorsConfiguration": {
      "additionalProperties": false,
      "properties": {
        "AllowCredentials": {
          "type": "boolean"
        },
        "AllowHeaders": {
          "type": "string"
        },
        "AllowMethods": {
          "type": "string"
        },
        "AllowOrigin": {
          "type": "string"
        },
        "MaxAge": {
          "type": "string"
        }
      },
      "required": [
        "AllowOrigin"
      ],
      "type": "object"
    },
    "AWS::Serverless::Api.DomainConfiguration": {
      "additionalProperties": false,
      "properties": {
        "BasePath": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "CertificateArn": {
          "type": "string"
        },
        "DomainName": {
          "type": "string"
        },
        "EndpointConfiguration": {
          "enum": [
            "REGIONAL",
            "EDGE"
          ],
          "type": "string"
        },
        "MutualTlsAuthentication": {
          "$ref": "file:common.json#definitions/AWS::ApiGatewayV2::DomainName.MutualTlsAuthentication"
        },
        "Route53": {
          "$ref": "#definitions/AWS::Serverless::Api.Route53Configuration"
        },
        "SecurityPolicy": {
          "type": "string"
        }
      },
      "required": [
        "CertificateArn",
        "DomainName"
      ],
      "type": "object"
    },
    "AWS::Serverless::Api.EndpointConfiguration": {
      "additionalProperties": false,
      "properties": {
        "Type": {
          "enum": [
            "REGIONAL",
            "EDGE",
            "PRIVATE"
          ],
          "type": "string"
        },
        "VPCEndpointIds": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.LambdaAuthorizer": {
      "if": {
        "required": [
          "FunctionArn"
        ]
      },
      "then": {
        "additionalProperties": false,
        "properties": {
          "AuthorizationScopes": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "FunctionArn": {
            "type": "string"
          },
          "FunctionInvokeRole": {
            "type": "string"
          },
          "FunctionPayloadType": {
            "enum": [
              "TOKEN",
              "REQUEST"
            ],
            "type": "string"
          },
          "Identity": {
            "oneOf": [
              {
                "$ref": "#definitions/AWS::Serverless::Api.LambdaRequestAuthorizationIdentity"
              },
              {
                "$ref": "#definitions/AWS::Serverless::Api.LambdaTokenAuthorizationIdentity"
              }
            ]
          }
        },
        "required": [
          "FunctionArn"
        ],
        "type": "object"
      }
    },
    "AWS::Serverless::Api.LambdaRequestAuthorizationIdentity": {
      "additionalProperties": false,
      "properties": {
        "Context": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "Headers": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "QueryStrings": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "ReauthorizeEvery": {
          "type": "integer",
          "maximum": 3600,
          "minimum": 1
        },
        "StageVariables": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.LambdaTokenAuthorizationIdentity": {
      "additionalProperties": false,
      "properties": {
        "ReauthorizeEvery": {
          "type": "integer",
          "maximum": 3600,
          "minimum": 1
        },
        "ValidationExpression": {
          "type": "string"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.ResourcePolicyStatement": {
      "additionalProperties": false,
      "properties": {
        "AwsAccountBlacklist": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "AwsAccountWhitelist": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "CustomStatements": {
          "items": {
            "type": "object"
          },
          "type": "array"
        },
        "IntrinsicVpcBlacklist": {
          "items": {
            "$ref": "file:common.js#definitions/StringOrIntrinsicRef"
          },
          "type": "array"
        },
        "IntrinsicVpcWhitelist": {
          "items": {
            "$ref": "file:common.js#definitions/StringOrIntrinsicRef"
          },
          "type": "array"
        },
        "IntrinsicVpceBlacklist": {
          "items": {
            "$ref": "file:common.js#definitions/StringOrIntrinsicRef"
          },
          "type": "array"
        },
        "IntrinsicVpceWhitelist": {
          "items": {
            "$ref": "file:common.js#definitions/StringOrIntrinsicRef"
          },
          "type": "array"
        },
        "IpRangeBlacklist": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "IpRangeWhitelist": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "SourceVpcBlacklist": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "SourceVpcWhitelist": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.Route53Configuration": {
      "additionalProperties": false,
      "properties": {
        "DistributionDomainName": {
          "type": "string"
        },
        "EvaluateTargetHealth": {
          "type": "boolean"
        },
        "oneOf": {
          "HostedZoneId": {
            "type": "string"
          },
          "HostedZoneName": {
            "type": "string"
          }
        },
        "IpV6": {
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "AWS::Serverless::Api.S3Location": {
      "additionalProperties": false,
      "properties": {
        "Bucket": {
          "type": "string"
        },
        "Key": {
          "type": "string"
        },
        "Version": {
          "type": "number"
        }
      },
      "required": [
        "Bucket",
        "Key"
      ],
      "type": "object"
    }
  },
  "type": "object"
}